#!/usr/bin/env bash

# Install nginx
apt-get update
apt-get -y install nginx

# Configure nginx to listen on port 80
sed -i 's/#listen 80/listen 80/' /etc/nginx/sites-available/default

# Restart nginx
kill $(cat /var/run/nginx.pid)
/usr/sbin/nginx

# Create a custom HTML file with "Hello World!" text
echo "<html><body>Hello World!</body></html>" > /var/www/html/index.html

# Test nginx by sending a GET request to its root and checking the response
response=$(curl -s http://localhost)
if [[ $response == *"Hello World!"* ]]; then
  echo "Nginx installation and configuration completed successfully"
else
  echo "Nginx installation and configuration failed"
fi
